buildscript {
    repositories {
        jcenter()
    }

  dependencies {
    classpath 'org.jfrog.buildinfo:build-info-extractor-gradle:4.+'
  }

}

allprojects {
    apply plugin: 'java-library'
    apply plugin: 'maven-publish'
    apply plugin: 'com.jfrog.artifactory'

    group = 'com.test'
    version = 'art-plugin-runtimeonly-SNAPSHOT'

    sourceCompatibility = 1.8
    targetCompatibility = 1.8

    repositories {
        maven {
            url 'http://localhost:8082/artifactory/libs-snapshot-local/'
            credentials {
                username = 'admin'
                password = 'password'
            }
        }
    }

    publishing {
        publications {
            mavenJava(MavenPublication) {
                from components.java
            }
        }
    }

    artifactory {
      contextUrl = 'http://localhost:8082/artifactory/'   //The base Artifactory URL if not overridden by the publisher/resolver
      publish {
        //A closure defining publishing information
        repository {
          repoKey = 'libs-snapshot-local'   //The Artifactory repository key to publish to
            username = 'admin'
            password = 'password'
        }
        defaults {
            //List of Gradle Publications (names or objects) from which to collect the list of artifacts to be deployed to Artifactory.
            publications('mavenJava')
            publishBuildInfo = true   //Publish build-info to Artifactory (true by default)
            publishArtifacts = true   //Publish artifacts to Artifactory (true by default)
            publishPom = true   //Publish generated POM files to Artifactory (true by default).
        }
      }
      resolve {
        contextUrl = 'http://localhost:8082/artifactory/'   //The base Artifactory URL for the resolver
        repository {
          repoKey = 'libs-snapshot-local'   //The Artifactory repository key to publish to
            username = 'admin'
            password = 'password'
        }
      }
    }
}
